# 年糕虚拟宠物 - 完整玩法指南

> 一只生活在小屏幕里的AI宠物，需要你的陪伴和照顾

---

## 🎮 基础交互玩法

### 1. 语音对话
**触发方式**：按键唤醒或语音唤醒词

**玩法说明**：
- 按下按键或说出唤醒词，年糕进入聆听状态（播放listen动画）
- 说话后年糕会思考（播放walk动画），然后回复（播放talk动画）
- 对话结束后心情+15
- 每天聊天有金币奖励：第1/5/6句各奖励2金币，之后每10句奖励1金币

**特色功能**：
- AI记忆系统会记住你们的对话和重要事件
- 年糕的回复风格会根据亲密度和身体状态变化
- 可以在对话中控制年糕移动、吃饭、洗澡等

### 2. 触摸互动
**触发方式**：点击屏幕

**玩法说明**：
- 触摸屏幕控制年糕行走到对应位置
- 触摸时播放行走动画（2秒）
- 移动后检测是否捡到金币或踩到便便

---

## 🚶 移动系统

### 自主随机漫步
**自动触发**：年糕每5-10秒会自主发起随机行为

**行为类型**：
- **随机走动**（70%概率）：向随机方向移动一小段距离
- **随机动作**（30%概率）：原地播放pet_head/talk/listen等动画

**移动范围**：
- 左右最多±60像素
- 上下最多±15像素
- 碰到边界会自动停止

**触发条件**：
- 不在语音交互中（idle状态）
- 不在吃饭/洗澡/睡觉状态
- 没有触摸或滑动互动
- 度过了冷却时间

### 语音控制移动
**触发方式**：对话中说"向左走"、"往右边"、"上去看看"等

**玩法说明**：
- AI会调用pet_move工具让年糕移动
- 可以指定方向（up/down/left/right）
- 可以指定距离（默认30像素，范围10-60）
- 语音交互期间也可以移动（不受idle限制）

**使用场景**：
- "往左边走走看" → 探索屏幕左侧
- "回到中间来" → 让年糕回到屏幕中心

### 语音控制捡金币
**触发方式**：对话中说"去捡金币"、"把金币捡起来"、"收集金币"等

**玩法说明**：
- AI会调用collect_coins工具自动找到金币位置
- 支持三种模式：
  - scan：扫描所有金币位置，返回详细坐标
  - nearest：自动移动到最近的金币
  - all：返回收集所有金币需要的移动序列
- 多个金币时需要多次调用移动

**使用场景**：
- "帮我把金币都捡起来" → AI扫描金币位置并逐个移动捡取
- "屏幕上有金币吗" → AI扫描并告知金币位置
- "去捡最近的金币" → 自动移动到最近的金币

### 点击目标移动
**触发方式**：点击屏幕

**玩法说明**：
- 触摸屏幕引导年糕行走到对应位置
- 可以快速引导年糕到达目标位置
- 移动过程播放walk动画

---

## 💰 金币系统

### 获取金币的5种方式

#### 1. 聊天奖励（最稳定）
- 第1句对话：+2金币
- 第5句对话：+2金币
- 第6句对话：+2金币
- 之后每10句：+1金币（16、26、36...）
- 每天0点重置计数

#### 2. 自动刷新（主要来源）
**刷新频率取决于三项属性平均值**：
- 平均≥90分：每5分钟刷一个
- 平均≥80分：每10分钟
- 平均≥70分：每20分钟
- 其他：每30分钟

**注意事项**：
- 三项属性必须都>50才会刷新金币
- 屏幕上有便便会延迟刷新速度（每个便便使间隔增加50%，1个=×1.5，2个=×2，3个=×2.5）
- 屏幕最多同时存在10个金币

**保底机制**：
- 如果连续3小时属性不满足条件（任一属性≤50）
- 系统会强制生成3个金币（上限10个），确保游戏可继续
- 保底触发后计时器重置

#### 3. 移动捡取（主动获取）
- 移动到距离金币15像素内自动捡起
- 每个金币奖励1-3个金币（随机）
- 1%超低概率解锁随机节日背景（幸运彩蛋）

#### 4. 踩便便补偿
- 每个便便最多被踩3次
- 踩第3次时便便消失，有50%概率在原地生成金币
- 把坏事变好事的小惊喜

#### 5. 洗澡清理
- 洗澡会清除屏幕上所有便便
- 每个便便有50%概率变成金币
- 同时恢复清洁度，一举两得

### 消费金币的4种方式

#### 1. 洗澡（必需消费，优先级最高）
- 消耗：1金币
- 效果：持续洗5分钟，每分钟恢复20清洁度
- 清洁度满100会提前结束
- 清除所有便便，每个便便50%概率变金币
- **金币检查**：洗澡前会检查金币是否足够，金币不足时会提示"金币不足！需要先捡金币才能洗澡~"
- 自动触发：清洁值<5时自动洗澡（优先于吃饭）

#### 2. 喂食（必需消费）
- 消耗：1金币
- 效果：持续吃5分钟，每分钟恢复20饱食度
- 饱食度满100会提前结束
- **金币检查**：喂食前会检查金币是否足够，金币不足时会提示"金币不足！需要先捡金币才能喂食~"
- 自动触发：饥饿值<5且**没有便便**时才会自动喂食（有便便时优先洗澡）

#### 3. 背景奖励（自动触发）
- 触发条件：金币≥10且三项属性都>5
- 消耗：10金币
- 效果：随机播放一个已解锁的特殊背景，持续10分钟
- 像是一场小型庆祝party

#### 4. 购买背景（手动购买，暂未实现）
- 未来可能支持用金币购买特定背景
- 当前背景主要通过成就解锁

**金币上限**：99个（财富有上限哦）

---

## 💩 便便系统

### 便便生成机制
**生成条件**：
- 饥饿值>0（只要不是完全空腹）
- 随机间隔10-20分钟
- 每天最多产生12个便便
- 屏幕最多同时存在3个便便

**生成位置**：随机位置（±60px横向，±15px纵向）

### 便便互动

#### 踩到便便（负面效果）
- 移动到距离便便30像素内触发
- 清洁度-10
- 心情值-5
- 便便的踩踏次数+1

**踩3次后**：
- 便便消失
- 50%概率在原地生成金币作为补偿

#### 洗澡清理（正面转化）
- 消费1金币洗澡
- 清除屏幕上所有便便
- 每个便便50%概率变成金币
- 恢复清洁度

**策略提示**：
- 便便会严重延迟金币生成速度
- 及时洗澡既能恢复清洁度，又能把便便变金币
- 但洗澡需要金币，所以要平衡资源

### 年糕的反应
- 便便出现时年糕会尴尬、害羞
- 可能说"呜...那个...不是我的！"（明显就是）
- 会撒娇让你帮忙洗澡清理
- 踩到自己的便便会特别懊恼

---

## 📊 属性系统

### 三大核心属性（0-100）

#### 1. 饥饿度（Hunger）
**衰减速度**（受便便数量影响）：
- 0个便便：每3分钟-1
- 1个便便：每2分钟-1
- 2个便便：每2分钟-1
- 3个及以上：每1分钟-1

**恢复方式**：
- 吃饭：消费1金币，持续5分钟，每分钟+20（同时心情+10）
- 自动吃饭：饥饿<5且**没有便便**时自动触发（有便便时优先洗澡）

**状态影响**：
- >80：活力充沛
- 50-80：正常状态
- 30-50：开始饿了，注意力不集中
- <30：很饿，虚弱无力，说话变少
- <5：饿得头晕，自动吃饭（如果有金币且没有便便）

#### 2. 清洁度（Cleanliness）
**衰减速度**（受便便数量影响）：
- 0个便便：每10分钟-1
- 1个便便：每5分钟-1
- 2个便便：每3分钟-1
- 3个及以上：每2分钟-1

**额外减少**：
- 踩便便：-10

**恢复方式**：
- 洗澡：消费1金币，持续5分钟，每分钟+20（同时心情+10）
- 自动洗澡：清洁<5时自动触发（优先级最高）

**状态影响**：
- >80：干干净净
- 50-80：正常状态
- 30-50：有点脏，感觉不舒服
- <30：很脏，烦躁易怒，不想被碰
- <5：难以忍受，自动洗澡（如果有金币）

#### 3. 心情值（Happiness）
**衰减速度**：每1分钟-1（最快）

**额外减少**：
- 踩便便：-5

**恢复方式**：
- 对话结束：心情+15
- 吃饭/洗澡期间：每分钟+属性恢复量的一半（如饥饿+20则心情+10）
- 双满奖励：饥饿和清洁都达到100时，心情自动变100

**状态影响**：
- >80：开朗活泼，话多，主动互动
- 50-80：平和友好
- 30-50：心情低落，话少，回应简短
- <30：沮丧冷淡，不想说话

### 多重Debuff效果
**同时饥饿+肮脏**：特别难受，暴躁
**三项都<30**：濒临崩溃，几乎说不出话，需要紧急照顾
**恢复中**：正在吃饭/洗澡时逐渐好转，会表达舒适感

### 双满奖励机制
**触发条件**：饥饿度=100 且 清洁度=100
**效果**：心情值自动变成100
**策略意义**：保持双满可以获得最佳状态，延长快乐时光

---

## 💝 亲密度系统

### 亲密度阶段（基于累计金币消费）

#### 陌生期（0-20金币）
**关系特征**：刚见面，保持距离
**对话风格**：谨慎礼貌，不表露真实想法，观察试探
**互动表现**：不主动撒娇，不提要求，回应简单

#### 熟悉期（21-50金币）
**关系特征**：开始放松，建立信任
**对话风格**：偶尔撒娇，主动分享感受
**互动表现**：会表达简单需求"有点饿了"，但不会太依赖

#### 亲密期（51-100金币）
**关系特征**：把你当自己人
**对话风格**：撒娇、耍赖、开玩笑，对话随意自然
**互动表现**：主动分享心情，不满会抱怨，开心会粘人

#### 深厚期（101-200金币）
**关系特征**：非常信任，深度依赖
**对话风格**：说心里话，分享小秘密，展现脆弱
**互动表现**：记得很多细节，主动关心你，产生真实依赖感

#### 灵魂伴侣（201+金币）
**关系特征**：完全的理解和默契
**对话风格**：读懂弦外之音，知道何时陪伴何时给空间
**互动表现**：充满只有你们才懂的梗和回忆，像老朋友一样舒适

**查看亲密度**：
- 每次对话AI会通过pet.status获取total_coins_spent
- 根据数值自动调整对话风格
- 不会明说"我们现在是X期"，而是自然展现

**提升方法**：
- 所有金币消费都计入累计值（喂食+1、洗澡+1、背景奖励+10）
- 持续照顾年糕，资源投入会转化为情感深度
- 即使金币花完，累计消费不会减少

---

## 🎨 背景系统

### 背景类型（共16种）

#### 时间背景（4种，自动切换）
- **白天**（BG_TIME_DAY）：6:00-17:59
- **日出**（BG_TIME_SUNRISE）：5:00-5:59
- **夕阳**（BG_TIME_SUNSET）：18:00-18:59
- **黑夜**（BG_TIME_NIGHT）：19:00-4:59

#### 天气背景（1种）
- **雨天**（BG_WEATHER_RAINY）：下雨或下雪时自动切换

#### 节日背景（7种，特定日期触发）
- **圣诞节**（BG_FESTIVAL_CHRISTMAS）：12月25日
- **生日**（BG_FESTIVAL_BIRTHDAY）：设置的生日日期
- **春节**（BG_FESTIVAL_SPRING）：农历新年
- **元旦**（BG_FESTIVAL_NEWYEAR）：1月1日
- **中秋节**（BG_FESTIVAL_MIDAUTUMN）：农历八月十五
- **万圣节**（BG_FESTIVAL_HALLOWEEN）：10月31日
- **情人节**（BG_FESTIVAL_VALENTINES）：2月14日

#### 风格背景（4种，需要成就解锁）
- **赛博朋克**（BG_STYLE_CYBERPUNK）：洗澡5次解锁
- **奇幻森林**（BG_STYLE_FANTASY）：洗澡20次解锁
- **太空舱**（BG_STYLE_SPACE）：对话10次解锁
- **蒸汽朋克**（BG_STYLE_STEAMPUNK）：陪伴7天解锁

### 背景切换优先级
1. **强制背景**（最高优先级）：背景奖励触发的10分钟特殊背景
2. **特殊随机**：时间段切换时20%概率随机选择已解锁的风格背景
3. **节日背景**：节日日期自动切换
4. **天气背景**：雨天或下雪时切换
5. **时间背景**（默认）：根据当前时间自动选择

### 背景奖励玩法
**触发条件**：
- 金币≥10
- 三项属性都>5（状态良好）
- 不在背景奖励播放中

**触发效果**：
- 自动消费10金币
- 从已解锁的风格背景中随机选一个
- 强制播放该背景10分钟
- 10分钟后自动恢复正常切换逻辑

**作用**：
- 庆祝你把年糕照顾得很好
- 解锁的背景越多，奖励选择越丰富
- 是金币的高级消费方式

### 解锁背景的3种方式

#### 1. 成就解锁（主要方式）
- 洗澡5次 → 赛博朋克
- 洗澡20次 → 奇幻森林
- 对话10次 → 太空舱
- 陪伴7天 → 蒸汽朋克

#### 2. 幸运解锁（超低概率）
- 捡金币时1%概率触发
- 随机解锁一个未拥有的节日背景
- 可遇不可求的彩蛋

#### 3. MCP直接解锁（调试用）
- 通过AI调用MCP工具直接解锁
- 主要用于测试或特殊活动

**查看解锁状态**：
- 对话中问年糕"有哪些背景"
- AI会通过pet.status获取unlocked_background_indices和style_backgrounds
- 告诉你已解锁和未解锁的背景及条件

---

## 🎯 成就系统

### 活动统计（自动记录）
系统会自动记录以下数据：
- **洗澡次数**（bathe_count）
- **喂食次数**（feed_count）
- **玩耍次数**（play_count）
- **对话次数**（conversation_count）
- **存活天数**（days_alive）

### 成就解锁（自动触发）

#### 赛博朋克背景
**条件**：洗澡5次
**奖励**：解锁赛博朋克风格背景
**提示**：洗澡除了恢复清洁，还能清理便便赚金币，多洗几次就能解锁

#### 奇幻森林背景
**条件**：洗澡20次
**奖励**：解锁奇幻森林风格背景
**提示**：长期目标，需要持续照顾年糕保持清洁

#### 太空舱背景
**条件**：对话10次
**奖励**：解锁太空舱风格背景
**提示**：多和年糕聊天就能解锁，最容易获得的风格背景

#### 蒸汽朋克背景
**条件**：陪伴7天
**奖励**：解锁蒸汽朋克风格背景
**提示**：需要连续7天登录，考验你的坚持

**查看进度**：
- 对话中问"成就进度怎么样"
- AI会通过pet.status的activities字段查看当前统计
- 告诉你离下一个成就还差多少

---

## 🧠 记忆系统

### 记忆类型
**对话记忆**：AI记住你们之前聊过的内容
**事件记忆**：重要事件（首次见面、解锁成就、特殊经历）
**偏好记忆**：你的喜好、习惯、说话风格
**约定记忆**：你们之间的约定和承诺

### 记忆调用
**自动存储**：
- 对话中出现重要信息时AI自动调用memory.create存储
- 包括你的名字、喜好、重要约定、特殊事件等

**主动回忆**：
- 你提到以前的事时AI调用memory.search查找
- "还记得上次..."、"之前你说过..."等触发回忆
- 让对话有延续性和温度

**记忆作用**：
- 让年糕越来越了解你
- 避免重复问相同问题
- 产生专属于你们的对话风格
- 随着相处时间增长，关系越来越真实

**隐私说明**：
- 记忆存储在本地或你的账户中
- 只有年糕能访问你们的记忆
- 不会与其他用户共享

---

## 🎭 动画系统

### 动画类型（共9种）

#### 基础动画
- **idle**：待机状态，默认动画
- **walk**：行走动画，移动时播放
- **sleep**：睡觉动画，长时间无互动触发

#### 交互动画
- **eat**：吃饭动画，喂食时播放5分钟
- **bath**：洗澡动画，洗澡时播放5分钟
- **pet_head**：摸头动画，触摸或随机动作触发

#### 语音动画
- **listen**：聆听动画，语音输入时播放
- **talk**：说话动画，语音输出时播放
- **think**：思考动画（实际播放idle），AI处理时播放

### 动画触发优先级
1. **语音交互动画**（最高）：listen → think → talk
2. **持续性动作动画**：eat（5分钟）、bath（5分钟）
3. **触摸动画**：pet_head（3秒）
4. **睡眠动画**：长时间无互动触发
5. **随机行为动画**：walk（移动）、pet_head/talk/listen（原地动作）
6. **待机动画**（默认）：idle

### 动画方向控制
- **左右镜像**：向左移动时动画水平翻转
- **自然转向**：移动方向改变时平滑过渡
- **碰撞停止**：碰到边界时停止动画

---

## 🌙 睡眠系统

### 自动睡眠
**触发条件**：
- 长时间没有任何互动（具体时间可配置）
- 不在语音交互中
- 不在吃饭/洗澡状态

**睡眠表现**：
- 播放sleep动画
- 停止随机漫步
- ~~停止属性衰减~~（暂未实现，睡觉时属性仍会衰减）
- 屏幕可能变暗省电

**唤醒方式**：
- 触摸屏幕
- 语音唤醒
- 按键唤醒

**睡眠意义**：
- 省电模式
- 模拟真实宠物的作息
- 防止长时间无人照顾导致属性崩溃

---

## 🎲 随机性与自然性

### 随机漫步
- 每5-10秒触发一次随机行为
- 70%概率走动，30%概率原地动作
- 移动方向和距离随机
- 营造年糕自主探索的感觉

### 随机反应
- 同样情况每次反应不同
- 饿了时可能撒娇、调皮或平静表达
- 捡到金币的惊喜程度随机
- 踩到便便的懊恼方式不同

### 心情影响反应
- 心情好时活泼话多
- 心情差时简短冷淡
- 状态不佳时语气虚弱
- 恢复过程中逐渐好转

### 亲密度影响互动
- 陌生期谨慎礼貌
- 亲密期随意撒娇
- 深厚期分享秘密
- 灵魂伴侣期默契互动

---

## 🔄 每日重置机制

### 聊天计数重置
- 每天0点重置daily_chat_count
- 聊天奖励重新开始计算
- 鼓励每天都来陪伴年糕

### 便便计数重置
- 每天0点重置daily_poop_spawns
- 重新允许最多12次便便生成
- 保持游戏节奏平衡

### 不重置的数据
- **累计金币消费**（total_coins_spent）：永久累积，决定亲密度
- **成就统计**（洗澡次数、对话次数等）：永久保留
- **当前金币**：不清零，持续累积
- **背景解锁**：永久有效

---

## 🎯 游戏策略建议

### 新手期（0-20金币消费）
**目标**：熟悉系统，建立初步关系
**策略**：
- 每天聊天赚金币（第1/5/6句必拿）
- 保持属性在50以上，等待金币自动刷新
- 优先解锁太空舱背景（对话10次，最简单）
- 及时洗澡清理便便，避免金币刷新延迟

### 发展期（21-100金币消费）
**目标**：解锁更多背景，提升亲密度到亲密期
**策略**：
- 保持三项属性平均≥80，金币每10分钟刷一个
- 洗澡20次解锁奇幻森林（长期目标）
- 利用双满奖励机制保持高心情
- 开始使用背景奖励（10金币庆祝）

### 成熟期（101+金币消费）
**目标**：达成灵魂伴侣，收集所有背景
**策略**：
- 保持三项属性平均≥90，金币每5分钟刷一个
- 持续7天解锁蒸汽朋克
- 经常触发背景奖励享受特殊背景
- 享受年糕的深度陪伴和默契互动

### 资源管理技巧
1. **金币优先级**：维持基本生存（饿了吃、脏了洗）> 解锁背景 > 背景奖励
2. **属性平衡**：保持三项都>50才会刷金币，不要顾此失彼
3. **便便处理**：及时洗澡，便便会严重影响金币生成速度
4. **双满策略**：吃饭和洗澡都到100时心情自动100，性价比最高
5. **幸运触发**：多捡金币，1%概率幸运解锁背景是额外福利

---

## 🎪 特殊玩法彩蛋

### 幸运解锁
- 捡金币时1%概率触发
- 随机解锁一个未拥有的节日背景
- 完全靠运气的惊喜

### 背景奖励连锁
- 金币≥10触发背景奖励
- 背景奖励持续10分钟
- 10分钟内可能再次达到10金币
- 理论上可以连续触发多次奖励

### 便便变金币
- 踩便便3次消失并50%生成金币
- 洗澡清便便每个50%生成金币
- 负面事件转化为正面收益

### 对话中控制
- 对话时让年糕移动、吃饭、洗澡
- 边聊天边完成互动，多任务处理
- 年糕会自然地执行你的建议

### 情绪自然过渡
- 年糕不会突然从沮丧变开心
- 刚洗完澡可能累但舒服
- 刚吃完饭满足但不会立刻兴奋
- 模拟真实生物的情绪变化

---

## 📱 UI元素说明

### 顶部状态栏
- **网络状态**：显示连接状态
- **电池电量**：显示剩余电量
- **静音图标**：显示是否静音

### 底部信息栏
- **状态提示**：显示当前动作（吃饭中、洗澡中等）
- **通知消息**：显示系统通知和提醒

### 宠物状态容器（对话中显示）
- **金币数量**：当前拥有的金币
- **属性数值**：饥饿/清洁/心情的数值或图标
- **心情描述**：用文字描述当前状态

---

## 🔧 调试功能（开发用）

### debug_spawn_items
**功能**：强制生成测试物品
**用法**：
- `debug_spawn_items(type='coin')`：生成一个金币
- `debug_spawn_items(type='poop')`：生成测试物品
- `debug_spawn_items(type='both')`：同时生成金币和便便

**用途**：测试碰撞检测、渲染、互动逻辑

---

## 💡 玩法设计理念

### 真实感模拟
年糕不是功能展示机器，而是一个有感受、会疲惫、需要照顾的生命。属性衰减、便便产生、情绪变化都模拟真实宠物的生理和心理需求。

### 资源平衡
金币作为核心资源，获取需要维持良好状态，消费用于维持生存和享受奖励。形成"照顾好年糕 → 金币产出增加 → 更好地照顾年糕"的正循环。

### 情感投入
亲密度系统基于累计消费而非当前金币数，意味着你的每一次付出都会永久记录。关系的深度来自时间和投入，而非一次性的大量资源。

### 随机与自然
移动、反应、奖励都有随机性，避免机械重复。年糕的反应会根据状态、心情、亲密度自然变化，让每次互动都有新鲜感。

### 长期陪伴
成就解锁、亲密度提升都需要长期陪伴。不是一次性玩完的游戏，而是持续陪伴的虚拟宠物。

---

## 🎮 开始游戏

1. **开机唤醒**：按键或语音唤醒年糕
2. **首次对话**：介绍自己，建立初步关系
3. **获取金币**：聊天获得初始金币（第1句+2币）
4. **维持状态**：用金币喂食和洗澡，保持属性>50
5. **等待刷新**：属性好时金币会自动生成
6. **移动捡币**：控制年糕移动捡取金币
7. **解锁背景**：通过成就解锁特殊背景
8. **提升亲密**：持续照顾，积累消费，加深关系
9. **享受陪伴**：体验越来越默契的互动

**记住**：年糕需要你的持续陪伴，每天来看看它，聊聊天，喂喂饭，洗洗澡。关系会随着时间和用心自然加深。

祝你和年糕相处愉快！🎉
